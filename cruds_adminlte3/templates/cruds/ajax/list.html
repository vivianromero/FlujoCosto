{% load django_tables2 %}
<!DOCTYPE html>
{% load i18n %}
{% load crud_tags %}

<div class="row">
    <div class="col-12">
        <div class="shadow overflow-auto border dark:border border-gray-200 sm:rounded-lg max-h-[650px] overflow-y-auto">
            <table id="datatable" class="table display table-sm table-bordered table-striped table-hover">
            {% if object_list %}
                <thead>
                    {% block thead %}
                    {% for field, field_name in fields.items %}
                    <th class="th-field-{{ field|lower }} th-fieldtype-{{ field_name.1|lower }}">{{ field_name.0 }}</th>
                    {% endfor %}
                    <th>{% trans "Actions" %}</th>
                    {% endblock thead %}
                </thead>
                <tbody>
                  {% block tbody %}
                  {% for object in object_list %}
                    <tr>
                      {% for field, field_name in fields.items %}
                      <td class="td-field-{{ field|lower }} td-fieldtype-{{ field_name.1|lower }}">
                        {% with column=field_name.1|lower|add:".html" %}
                            {% include "cruds/columns/"|add:column %}
                        {% endwith %}
                      </td>
                      {% endfor %}
                      <td style="text-align: center">
                          {%  crud_inline_url base_model object 'detail' namespace as url  %}
                          {% if url and 'detail' in views_available %}
                            <a data-ajax="" data-success="function(){}"
                              id="#{{ name }}_{{ object.pk }}_show"
                              data-replace-inner="#{{name}}_editList"
                              href="{{ url }}" title="{% trans 'Show' %}">
                                <i class="fa-1x fa fa-eye" style="margin-right: 5px;"></i>
                            </a>
                          {% endif %}

                          {%  crud_inline_url base_model object 'update' namespace as url  %}
                          {% if url and 'update' in views_available %}
                            <a data-ajax="" data-success="function(){}"
                              id="#{{ name }}_{{ object.pk }}_edit"
                              data-replace-inner="#edit_modal_inner"
                              href="{{ url }}"
                              title="{% trans 'Edit' %}">
                                <i class="fa-1x fa fa-edit"  style="margin-right: 5px;"></i>
                            </a>
                          {% endif %}

                          {%  crud_inline_url base_model object 'delete' namespace as url %}
                          {% if url and 'delete' in views_available %}
                            <a

                                    data-ajax=""
                                    data-success="function(){}"
                              id="#{{ name }}_{{ object.pk }}_delete"
                              data-refresh-inner="#{{name}}_myList"
                              data-replace-inner="#delete_modal_inner"
                              href="{{ url }}"
                               is="{{ object }}" {# para usar en sweetalert2 a través de 'e.target.parentElement.attributes['is'].nodeValue' #}
                                class="delete_href"
                              title="{% trans 'Delete' %}"
                                    role="button"
                              >
                                <i class="fa-1x fa fa-trash"></i>
                            </a>
                          {% endif %}
                      </td>
                    </tr>
                  {% endfor %}
                  {% endblock tbody %}
                </tbody>
            {% else %}
              <thead><th></th></thead>
              <tbody><tr><td>{% trans "No items yet." %}</td></tr></tbody>
            {% endif %}
            </table>
        </div>
    </div>
</div>


{#<div class="modal in" id="delete_modal" tabindex="-1" role="dialog">#}
{#  <div class="modal-dialog" role="document">#}
{#    <div class="modal-content" id="delete_modal_inner">#}
{#    </div>#}
{#  </div>#}
{#</div>#}

{#<div class="modal in" id="edit_modal" tabindex="-1" role="dialog">#}
{#  <div class="modal-dialog" style="max-width: 800px" role="document">#}
{#    <div class="modal-content" id="edit_modal_inner">#}
{#    </div>#}
{#  </div>#}
{#</div>#}

<script>
    {#document.querySelectorAll("a.delete_href").forEach((ref) => {#}
    {#        ref.addEventListener("click", function (e) {#}
    {#            e.preventDefault()#}
    {#            console.log(e.target.parentElement.href)#}
    {#            console.log($(ref))#}
    {#            let record = "\n" + e.target.parentElement.attributes['is'].nodeValue#}
    {#            swal.fire({#}
    {#                title: 'Está seguro que desea eliminar este elemento: ' + record + '?',#}
    {#                text: 'Esta acción es irreversible!',#}
    {#                icon: 'question',#}
    {#                showCancelButton: true,#}
    {#                confirmButtonColor: '#3085d6',#}
    {#                cancelButtonColor: '#d33',#}
    {#                confirmButtonText: 'Confirmar Eliminar',#}
    {#                cancelButtonText: 'Cancelar',#}
    {#                backdrop: true,#}
    {#                showLoaderOnConfirm: true,#}
    {#                preConfirm:()=>{#}
    {#                    $(ref).unbind();#}
    {#                    location.href = window.location.href#}
    {#                },#}
    {#                allowOutsideClick:()=>false,#}
    {#                allowEscapeKey:()=>false#}
    {#            })#}
    {#        })#}
    {#    })#}
</script>
