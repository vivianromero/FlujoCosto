{% load crispy_forms_filters %}
{% load i18n %}
{% load crispy_forms_tags %}
{% load crud_tags %}
{% if not form.helper %}
    {{ form.media }}
{% endif %}

<form
    id="{{name}}_{{object.pk}}_addedit"
    class="addedit"
     style="max-width: {{ max_width }}"
    action="{% crud_inline_url base_model inline_model action namespace %}"
    method="POST" enctype="multipart/form-data"
>
    {% csrf_token %}
    <div class="card-body row">
        <div class="col-md-12">
            {% if form.helper %}
                {% crispy form %}
            {% else %}
                {{ form|crispy }}
            {% endif %}
        </div>
    </div>


    <div class="card-footer">
        <div class="form-group">
            <div class="controls">
                <button id="id_ajax_form_btn_cancel" name="ajax_form_btn_cancel" type="button" class="btn btn-secondary" data-dismiss="modal">
                    <i class="fa fa-close"></i>
                    Cancelar
                </button>
                {% if action != 'detail' %}
                	<button hx-headers='{"X-CSRFToken":"{{ csrf_token }}", "event_action": "inline_submitted"}'
                        hx-vals='{"event_action": "inline_submitted"}'
                        hx-post="{{ request.path }}"
                        hx-trigger="click"
                        {% if hx_target %}hx-target="{{ hx_target }}" {% else %}hx-target="#id_{{ inline.name }}_myList"{% endif %}
                        {% if hx_swap %}hx-swap="{{ hx_swap }}" {% else %}hx-swap="innerHTML"{% endif %}
                        id="id_inline_form_btn_acept"
                        type="submit"
                        name="inline_form_btn_acept"
                        class="btn btn-primary">
                            <i class="fa fa-check"></i>
                        Aceptar
                    </button>
                {% endif %}
            </div>
        </div>
    </div>
</form>


<script>
    function productoMedida(){
        var idproducto = document.getElementById("id_productodetalle").value;
        var url = "/productmedidadetalle/";
          $.ajax({
            url: url,
            data: {
              'idproducto': idproducto
            },
            dataType: 'json',
            success: function (data) {
                 document.getElementById("id_medidadetalle").value = data["results"]["id"]
            }
          });
    }

    {#$('.modal #submit-id-submit').parent().parent().remove(); // FIXME: Remove the crispy buttons#}
    {#$('#edit_modal').modal('show');#}
</script>
